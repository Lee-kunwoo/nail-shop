{"ast":null,"code":"import React,{useEffect,useRef,useState}from'react';import'../styles/kkomap.scss';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ShopLocation=()=>{const mapRef=useRef(null);const[shopData,setShopData]=useState(null);useEffect(()=>{fetch('/data/nail_salon.json').then(res=>res.json()).then(data=>setShopData(data)).catch(error=>console.error('Error loading JSON:',error));},[]);useEffect(()=>{const createMap=()=>{if(window.kakao&&window.kakao.maps&&mapRef.current&&shopData&&shopData.length>0){const container=mapRef.current;const options={center:new window.kakao.maps.LatLng(shopData[0].latitude||33.450701,shopData[0].longitude||126.570667),// 기본 좌표 설정\nlevel:3};const map=new window.kakao.maps.Map(container,options);shopData.forEach(shop=>{if(shop.latitude&&shop.longitude){new window.kakao.maps.Marker({map:map,position:new window.kakao.maps.LatLng(shop.latitude,shop.longitude),title:shop.name});}});}};const loadScript=()=>{const script=document.createElement('script');script.src=`https://dapi.kakao.com/v2/maps/sdk.js?appkey=80d68b9c1c97f9edd72ef5e13725bb51&libraries=services&autoload=false`;script.async=\"true\";document.head.appendChild(script);script.onload=()=>{window.kakao.maps.load(()=>{if(shopData){Promise.all(shopData.map(shop=>{return new Promise((resolve,reject)=>{const geocoder=new window.kakao.maps.services.Geocoder();geocoder.addressSearch(shop.address,(result,status)=>{if(status===window.kakao.maps.services.Status.OK){resolve({...shop,latitude:result[0].y,longitude:result[0].x});}else{console.error(`${shop.name} GeoCoding error: ${status}`);resolve({...shop,latitude:null,longitude:null});}});});})).then(updatedShopData=>{setShopData(updatedShopData);createMap();});}});};return()=>{document.head.removeChild(script);};};if(!window.kakao){loadScript();}else if(shopData){// shopData가 있을 때만 createMap 호출\ncreateMap();}},[shopData]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"JUNGWON-NAILART SHOP\"}),/*#__PURE__*/_jsx(\"div\",{className:\"map\",children:/*#__PURE__*/_jsx(\"div\",{ref:mapRef,style:{width:'700px',height:'600px'}})})]});};export default ShopLocation;","map":{"version":3,"names":["React","useEffect","useRef","useState","jsx","_jsx","jsxs","_jsxs","ShopLocation","mapRef","shopData","setShopData","fetch","then","res","json","data","catch","error","console","createMap","window","kakao","maps","current","length","container","options","center","LatLng","latitude","longitude","level","map","Map","forEach","shop","Marker","position","title","name","loadScript","script","document","createElement","src","async","head","appendChild","onload","load","Promise","all","resolve","reject","geocoder","services","Geocoder","addressSearch","address","result","status","Status","OK","y","x","updatedShopData","removeChild","children","className","ref","style","width","height"],"sources":["C:/nailmall/src/pages/SalonLocation.jsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\nimport '../styles/kkomap.scss';\r\n\r\nconst ShopLocation = () => {\r\n  const mapRef = useRef(null);\r\n  const [shopData, setShopData] = useState(null);\r\n\r\n  useEffect(() => {\r\n    fetch('/data/nail_salon.json')\r\n      .then(res => res.json())\r\n      .then(data => setShopData(data))\r\n      .catch(error => console.error('Error loading JSON:', error));\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const createMap = () => {\r\n      if (window.kakao && window.kakao.maps && mapRef.current && shopData && shopData.length > 0) {\r\n        const container = mapRef.current;\r\n        const options = {\r\n          center: new window.kakao.maps.LatLng(shopData[0].latitude || 33.450701, shopData[0].longitude || 126.570667), // 기본 좌표 설정\r\n          level: 3,\r\n        };\r\n        const map = new window.kakao.maps.Map(container, options);\r\n\r\n        shopData.forEach(shop => {\r\n          if (shop.latitude && shop.longitude) {\r\n            new window.kakao.maps.Marker({\r\n              map: map,\r\n              position: new window.kakao.maps.LatLng(shop.latitude, shop.longitude),\r\n              title: shop.name,\r\n            });\r\n          }\r\n        });\r\n      }\r\n    };\r\n\r\n    const loadScript = () => {\r\n      const script = document.createElement('script');\r\n      script.src = `https://dapi.kakao.com/v2/maps/sdk.js?appkey=80d68b9c1c97f9edd72ef5e13725bb51&libraries=services&autoload=false`;\r\n      script.async = \"true\";\r\n      document.head.appendChild(script);\r\n\r\n      script.onload = () => {\r\n        window.kakao.maps.load(() => {\r\n          if (shopData) {\r\n            Promise.all(\r\n              shopData.map(shop => {\r\n                return new Promise((resolve, reject) => {\r\n                  const geocoder = new window.kakao.maps.services.Geocoder();\r\n                  geocoder.addressSearch(shop.address, (result, status) => {\r\n                    if (status === window.kakao.maps.services.Status.OK) {\r\n                      resolve({\r\n                        ...shop,\r\n                        latitude: result[0].y,\r\n                        longitude: result[0].x,\r\n                      });\r\n                    } else {\r\n                      console.error(`${shop.name} GeoCoding error: ${status}`);\r\n                      resolve({\r\n                        ...shop,\r\n                        latitude: null,\r\n                        longitude: null,\r\n                      });\r\n                    }\r\n                  });\r\n                });\r\n              })\r\n            ).then(updatedShopData => {\r\n              setShopData(updatedShopData);\r\n              createMap();\r\n            });\r\n          }\r\n        });\r\n      };\r\n\r\n      return () => {\r\n        document.head.removeChild(script);\r\n      };\r\n    };\r\n\r\n    if (!window.kakao) {\r\n      loadScript();\r\n    } else if (shopData) { // shopData가 있을 때만 createMap 호출\r\n      createMap();\r\n    }\r\n  }, [shopData]);\r\n\r\n  return (\r\n    <div>\r\n      <h2>JUNGWON-NAILART SHOP</h2>\r\n      <div className='map'>\r\n        <div ref={mapRef} style={{ width: '700px', height: '600px' }}></div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ShopLocation;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}